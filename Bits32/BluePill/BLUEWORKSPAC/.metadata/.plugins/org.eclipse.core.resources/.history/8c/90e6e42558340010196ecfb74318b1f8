/*
 * UnerProtocol.c
 *
 *  Created on: May 18, 2025
 *      Author: santi
 */

#include "UnerProtocol.h"



void SendInfo(uint8_t bufferAux[], uint8_t bytes,_eEstadoMEFcmd cmd){

    uint8_t bufAux[30], indiceAux=0,cks=0,num_bytes=0;

    bufAux[indiceAux++]='U';
    bufAux[indiceAux++]='N';
    bufAux[indiceAux++]='E';
    bufAux[indiceAux++]='R';

    num_bytes = indiceAux; //aca guardo la ubicacion de la cantidad de bytes a enviar

    bufAux[indiceAux++]=0;
    bufAux[indiceAux++]=':';
    bufAux[indiceAux++] = cmd;

    for(uint8_t i=0; i<bytes-1; i++)
        bufAux[indiceAux++] = bufferAux[i];

    if(cmd==TEXT)
		bufAux[num_bytes] = bytes; // aca le doy el numero de bytes que voy a pasar

    cks=0;
    for(uint8_t i=0 ;i<indiceAux;i++){
        cks^= bufAux[i];
        datosComSerie.bufferTx[datosComSerie.indexWriteTx++]=bufAux[i];
    }
     datosComSerie.bufferTx[datosComSerie.indexWriteTx++]=cks;

}
