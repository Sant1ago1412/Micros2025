/*
 * Cinta_Final.c
 *
 * Created: 07/04/2025 14:45:21
 * Author : Baccon
 */ 

/* Includes ------------------------------------------------------------------*/
#include <avr/io.h>
#include <avr/interrupt.h>
#include <avr/pgmspace.h>
/* END Includes --------------------------------------------------------------*/


/* typedef -------------------------------------------------------------------*/

typedef union{
	struct{
		uint8_t bit0: 1;
		uint8_t bit1: 1;
		uint8_t bit2: 1;
		uint8_t bit3: 1;
		uint8_t bit4: 1;
		uint8_t bit5: 1;
		uint8_t bit6: 1;
		uint8_t bit7: 1;
	}bits;
	uint8_t byte;
}flags;

typedef struct{
	
	enum sizeBox{
		SmallBox,
		MediumBox,
		LargeBox
	}boxSize;
	enum State{
		isOn,
		Push,
		isOut,
	}boxState;
	
	uint16_t  Numbox;
	
}s_boxType;
/* END typedef ---------------------------------------------------------------*/


/* define --------------------------------------------------------------------*/

#define IS10MS				flag0.bits.bit0
/*------PIN DECLARATION------*/
#define LED_BI			PB5

/************************************************************************/
/*							Pin Declaration Servos                      */
/************************************************************************/
#define SV0				PD7
#define SV1				PB4
#define SV2				PB3|

/************************************************************************/
/*							Pin Declaration IR's                        */
/************************************************************************/
#define IR0				PD2
#define IR1				PD3
#define IR2				PD4
#define IR3				PD5

/************************************************************************/
/*							Pin Declaration HCSR                        */
/************************************************************************/
#define ECHO			PB0
#define TRIGGER			PB1

/* END define ----------------------------------------------------------------*/


/* Function prototypes -------------------------------------------------------*/

/* END Function prototypes ---------------------------------------------------*/


/* Global variables ----------------------------------------------------------*/

/* END Global variables ------------------------------------------------------*/


/* Constant in Flash ---------------------------------------------------------*/

/* END Constant in Flash -----------------------------------------------------*/


/* Function ISR --------------------------------------------------------------*/

/* END Function ISR ----------------------------------------------------------*/


/* Function prototypes user code ----------------------------------------------*/
void ini_ports(){
	
	/************************************************************************/
	/*								OUTPUTS                                 */
	/************************************************************************/
	DDRB = ((1 << LED_BI)| (1 << SV1) | (1 << SV2) | (1<<TRIGGER));
	DDRD = (1 << SV0);
	/************************************************************************/
	/*								INTPUTS                                 */
	/************************************************************************/
	
	DDRB &= ~(1<<ECHO);
	DDRD &= ~((1<<IR0) | (1<<IR1) | (1<<IR2) | (1<<IR3));
	PORTB = (1<<ECHO);
	PORTD = ((1<<IR0) | (1<<IR1) | (1<<IR2) | (1<<IR3));
}

void ini_timer1(){
	
	TCCR1A = 0x00;
	//configuro el Prescaler 8 (f = 16MHz / 8 = 2MHz ? 1 tick = 0.5 µs)
	TCCR1B = 0xC2;
	// CONFIGURACION DE LA CANCELACION DE RUIDO
	TCNT1 = 0x00;
	TIMSK1 = (1<<OCIE1B);
	OCR1B = 19999;
	TIFR1 = TIFR1;
	
}
/* END Function prototypes user code ------------------------------------------*/

int main()
{
	/* Local variables -----------------------------------------------------------*/

	/* END Local variables -------------------------------------------------------*/




	/* User code Init ------------------------------------------------------------*/
	
	/* END User code Init --------------------------------------------------------*/


	while (1){
		/* User Code loop ------------------------------------------------------------*/

		/* END User Code loop --------------------------------------------------------*/
	}

	return 0;
}

